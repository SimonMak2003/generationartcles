<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор Кодекса США</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Tenor+Sans&family=Unica+One&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tenor Sans', serif;
            background: linear-gradient(135deg, #0a2a66 0%, #143d7a 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            color: #cdd9ff;
        }

        .generator-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .form-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .form-section h2 {
            font-family: 'Playfair Display', serif;
            color: #0a2a66;
            margin-bottom: 20px;
            font-size: 24px;
            border-bottom: 2px solid #0a2a66;
            padding-bottom: 10px;
        }

        .mode-selector {
            margin-bottom: 25px;
        }

        .mode-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #0a2a66;
        }

        .radio-group {
            display: flex;
            gap: 20px;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0;
            font-weight: normal;
            cursor: pointer;
        }

        .radio-group input[type="radio"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #0a2a66;
            font-size: 14px;
        }

        .form-group input[type="text"],
        .form-group input[type="url"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: 'Tenor Sans', serif;
            font-size: 14px;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="url"]:focus {
            outline: none;
            border-color: #0a2a66;
            box-shadow: 0 0 5px rgba(10, 42, 102, 0.3);
        }

        .add-btn {
            background: #0a2a66;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Tenor Sans', serif;
            font-size: 13px;
            transition: background 0.3s;
            width: 100%;
        }

        .add-btn:hover {
            background: #143d7a;
        }

        .remove-btn {
            background: #c0392b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 5px;
            transition: background 0.3s;
        }

        .remove-btn:hover {
            background: #a93226;
        }

        .hierarchy-item {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #0a2a66;
        }

        .hierarchy-item.law {
            border-left-color: #003366;
            margin-left: 20px;
        }

        .hierarchy-item.chapter {
            border-left-color: #1a5490;
            margin-left: 40px;
        }

        .hierarchy-item.article {
            border-left-color: #2e7fb8;
            margin-left: 60px;
        }

        .hierarchy-item.subarticle {
            border-left-color: #4a9fd8;
            margin-left: 80px;
        }

        .hierarchy-item h4 {
            color: #0a2a66;
            margin-bottom: 10px;
            font-size: 12px;
            text-transform: uppercase;
        }

        .generate-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Tenor Sans', serif;
            font-size: 16px;
            font-weight: bold;
            transition: background 0.3s;
            width: 100%;
            margin-top: 20px;
        }

        .generate-btn:hover {
            background: #218838;
        }

        .output-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            grid-column: 1 / -1;
        }

        .output-section h2 {
            font-family: 'Playfair Display', serif;
            color: #0a2a66;
            margin-bottom: 20px;
            font-size: 24px;
            border-bottom: 2px solid #0a2a66;
            padding-bottom: 10px;
        }

        .code-output {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #333;
            line-height: 1.4;
        }

        .copy-btn {
            background: #0a2a66;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Tenor Sans', serif;
            font-size: 14px;
            margin-top: 15px;
            transition: background 0.3s;
        }

        .copy-btn:hover {
            background: #143d7a;
        }

        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 12px 20px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #c3e6cb;
        }

        .success-message.show {
            display: block;
        }

        .scrollable-form {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .scrollable-form::-webkit-scrollbar {
            width: 8px;
        }

        .scrollable-form::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .scrollable-form::-webkit-scrollbar-thumb {
            background: #0a2a66;
            border-radius: 10px;
        }

        @media screen and (max-width: 1200px) {
            .generator-wrapper {
                grid-template-columns: 1fr;
            }

            .output-section {
                grid-column: 1;
            }
        }

        .section-title {
            font-weight: bold;
            color: #0a2a66;
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 12px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Генератор Кодекса США</h1>
            <p>Создавайте структурированное содержание американского права с интерактивными ссылками</p>
        </div>

        <div class="generator-wrapper">
            <div class="form-section">
                <h2>Параметры Кодекса</h2>

                <div class="mode-selector">
                    <label>Режим создания:</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="mode" value="new" checked>
                            Новая редакция
                        </label>
                        <label>
                            <input type="radio" name="mode" value="addition">
                            Дополнение
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Название Кодекса:</label>
                    <input type="text" id="codexName" placeholder="Кодекс Соединённых Штатов" value="Кодекс Соединённых Штатов">
                </div>

                <div class="form-group">
                    <label>Название на английском:</label>
                    <input type="text" id="codexNameEn" placeholder="The United States Code" value="The United States Code">
                </div>

                <div class="form-group">
                    <label>Девиз/Цитата:</label>
                    <input type="text" id="codexQuote" placeholder="The law must be stable, but it must not stand still" value="The law must be stable, but it must not stand still">
                </div>

                <div class="section-title">Разделы Кодекса</div>
                <div class="scrollable-form" id="sectionsContainer"></div>
                <button class="add-btn" onclick="addSection()">+ Добавить раздел</button>

                <button class="generate-btn" onclick="generateCode()">Сгенерировать код</button>
            </div>

            <div class="form-section" style="grid-column: 1 / -1;">
                <div class="output-section">
                    <h2>Готовый код</h2>
                    <div class="code-output" id="codeOutput">Сгенерированный код появится здесь...</div>
                    <button class="copy-btn" onclick="copyToClipboard()">Скопировать в буфер обмена</button>
                    <div class="success-message" id="successMessage">✓ Код скопирован в буфер обмена!</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let sectionCount = 0;
        let lawCount = 0;
        let chapterCount = 0;
        let articleCount = 0;

        function addSection() {
            const container = document.getElementById('sectionsContainer');
            const id = sectionCount++;
            
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'hierarchy-item';
            sectionDiv.id = `section-${id}`;
            sectionDiv.innerHTML = `
                <h4>Раздел</h4>
                <div class="form-group">
                    <label>Номер раздела:</label>
                    <input type="text" class="sectionNum" placeholder="1" value="1">
                </div>
                <div class="form-group">
                    <label>Название раздела:</label>
                    <input type="text" class="sectionName" placeholder="Выборы">
                </div>
                <div class="form-group">
                    <label>Название на английском:</label>
                    <input type="text" class="sectionNameEn" placeholder="Elections">
                </div>
                <div class="laws-container" id="laws-container-${id}"></div>
                <button class="add-btn" onclick="addLaw(${id})">+ Добавить закон в раздел</button>
                <button class="remove-btn" onclick="removeSection(${id})">✕ Удалить раздел</button>
            `;
            
            container.appendChild(sectionDiv);
        }

        function addLaw(sectionId) {
            const container = document.getElementById(`laws-container-${sectionId}`);
            const id = lawCount++;
            
            const lawDiv = document.createElement('div');
            lawDiv.className = 'hierarchy-item law';
            lawDiv.id = `law-${id}`;
            lawDiv.innerHTML = `
                <h4>Закон</h4>
                <div class="form-group">
                    <label>Обозначение закона:</label>
                    <input type="text" class="lawDesignation" placeholder="Public Law 1 - 1">
                </div>
                <div class="form-group">
                    <label>Название закона:</label>
                    <input type="text" class="lawName" placeholder="Election of the President">
                </div>
                <div class="form-group">
                    <label>Название на английском:</label>
                    <input type="text" class="lawNameEn" placeholder="Election Act">
                </div>
                <div class="form-group">
                    <label>Русское названи закона (полное):</label>
                    <input type="text" class="lawNameRu" placeholder="Акт о порядке проведения выборов">
                </div>
                <div class="form-group">
                    <label>Ссылка на закон:</label>
                    <input type="url" class="lawLink" placeholder="https://...">
                </div>
                <div class="chapters-container" id="chapters-container-${id}"></div>
                <button class="add-btn" onclick="addChapter(${id})">+ Добавить главу</button>
                <button class="remove-btn" onclick="removeLaw(${id})">✕ Удалить закон</button>
            `;
            
            container.appendChild(lawDiv);
        }

        function addChapter(lawId) {
            const container = document.getElementById(`chapters-container-${lawId}`);
            const id = chapterCount++;
            
            const chapterDiv = document.createElement('div');
            chapterDiv.className = 'hierarchy-item chapter';
            chapterDiv.id = `chapter-${id}`;
            chapterDiv.innerHTML = `
                <h4>Глава</h4>
                <div class="form-group">
                    <label>Номер главы:</label>
                    <input type="text" class="chapterNum" placeholder="I">
                </div>
                <div class="form-group">
                    <label>Название главы:</label>
                    <input type="text" class="chapterName" placeholder="Основные положения">
                </div>
                <div class="form-group">
                    <label>Ссылка на главу:</label>
                    <input type="url" class="chapterLink" placeholder="https://...">
                </div>
                <div class="articles-container" id="articles-container-${id}"></div>
                <button class="add-btn" onclick="addArticle(${id})">+ Добавить статью</button>
                <button class="remove-btn" onclick="removeChapter(${id})">✕ Удалить главу</button>
            `;
            
            container.appendChild(chapterDiv);
        }

        function addArticle(chapterId) {
            const container = document.getElementById(`articles-container-${chapterId}`);
            const id = articleCount++;
            
            const articleDiv = document.createElement('div');
            articleDiv.className = 'hierarchy-item article';
            articleDiv.id = `article-${id}`;
            articleDiv.innerHTML = `
                <h4>Статья</h4>
                <div class="form-group">
                    <label>Номер статьи:</label>
                    <input type="text" class="articleNum" placeholder="1">
                </div>
                <div class="form-group">
                    <label>Название статьи:</label>
                    <input type="text" class="articleName" placeholder="Определения">
                </div>
                <div class="form-group">
                    <label>Ссылка на статью:</label>
                    <input type="url" class="articleLink" placeholder="https://...">
                </div>
                <div class="subarticles-container" id="subarticles-container-${id}"></div>
                <button class="add-btn" onclick="addSubarticle(${id})">+ Добавить подстатью</button>
                <button class="remove-btn" onclick="removeArticle(${id})">✕ Удалить статью</button>
            `;
            
            container.appendChild(articleDiv);
        }

        function addSubarticle(articleId) {
            const container = document.getElementById(`subarticles-container-${articleId}`);
            const id = articleCount++;
            
            const subarticleDiv = document.createElement('div');
            subarticleDiv.className = 'hierarchy-item subarticle';
            subarticleDiv.id = `subarticle-${id}`;
            subarticleDiv.innerHTML = `
                <h4>Подстатья</h4>
                <div class="form-group">
                    <label>Обозначение подстатьи:</label>
                    <input type="text" class="subarticleDesignation" placeholder="(a)">
                </div>
                <div class="form-group">
                    <label>Название подстатьи:</label>
                    <input type="text" class="subarticleName" placeholder="Основная часть">
                </div>
                <div class="form-group">
                    <label>Ссылка на подстатью:</label>
                    <input type="url" class="subarticleLink" placeholder="https://...">
                </div>
                <button class="remove-btn" onclick="removeSubarticle(${id})">✕ Удалить подстатью</button>
            `;
            
            container.appendChild(subarticleDiv);
        }

        function removeSection(id) {
            document.getElementById(`section-${id}`).remove();
        }

        function removeLaw(id) {
            document.getElementById(`law-${id}`).remove();
        }

        function removeChapter(id) {
            document.getElementById(`chapter-${id}`).remove();
        }

        function removeArticle(id) {
            document.getElementById(`article-${id}`).remove();
        }

        function removeSubarticle(id) {
            document.getElementById(`subarticle-${id}`).remove();
        }

        function generateCode() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const codexName = document.getElementById('codexName').value || 'Кодекс Соединённых Штатов';
            const codexNameEn = document.getElementById('codexNameEn').value || 'The United States Code';
            const codexQuote = document.getElementById('codexQuote').value || 'The law must be stable, but it must not stand still';

            let code = '';

            if (mode === 'new') {
                code = generateFullCodex(codexName, codexNameEn, codexQuote);
            } else {
                code = generateAddition();
            }

            document.getElementById('codeOutput').textContent = code;
        }

        function generateFullCodex(name, nameEn, quote) {
            const sections = document.querySelectorAll('#sectionsContainer > .hierarchy-item');
            
            let html = `<!-- Используемые шрифты Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Tenor+Sans&family=Unica+One&display=swap" rel="stylesheet">

<!-- СТИЛИ -->
<style>
.codex-modal {
  display: none;
  position: fixed;
  z-index: 99;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
}

.codex-modal-content {
  background: #0a2a66;
  margin: 5% auto;
  padding: 20px;
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  overflow-y: auto;
  border-radius: 10px;
  position: relative;
  box-sizing: border-box;
}

.codex-close {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 24px;
  cursor: pointer;
  color: white;
}

.codex-modal-title {
  font-size: 22px;
  color: #fff;
  margin-bottom: 20px;
  text-align: center;
}

.codex-wrapper {
  background-color: #0a2a66;
  border-radius: 22px;
  color: #ffffff;
  padding-bottom: 30px;
  overflow: hidden;
  font-family: 'Tenor Sans', serif;
}

.codex-header {
  text-align: center;
  padding: 20px 10px 10px 10px;
  background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/United_States_Code_2012_Official_Edition.jpg/2560px-United_States_Code_2012_Official_Edition.jpg');
  background-size: cover;
  background-position: center;
  position: relative;
}

.codex-header::after {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(10, 42, 102, 0.8);
  z-index: 1;
}

.codex-header > * {
  position: relative;
  z-index: 2;
}

.codex-header img {
  max-width: 120px;
}

.law-header {
  text-align: center;
  padding: 20px 10px 10px 10px;
  position: relative;
}

.codex-title {
  font-family: 'Playfair Display', serif;
  font-size: 26px;
}

.law-title {
  font-family: 'Tenor Sans', serif;
  font-size: 22px;
  margin-top: 5px;
}

.law-title-en {
  font-family: 'Unica One', cursive;
  font-size: 15px;
  letter-spacing: 1px;
  margin-bottom: 10px;
}

.codex-quote {
  font-style: italic;
  font-size: 14px;
  max-width: 600px;
  margin: 10px auto 0 auto;
  color: #cdd9ff;
  text-align: center;
}

.codex-divider {
  height: 4px;
  background: linear-gradient(to right, #b22234 25%, #ffffff 25%, #ffffff 75%, #3c3b6e 75%);
  margin: 10px auto 0px auto;
  width: 90%;
  max-width: 850px;
  border-radius: 2px;
}

.codex-section {
  max-width: 850px;
  margin: 0 auto 30px auto;
  padding: 20px;
  background-color: #143d7a;
  border-radius: 20px;
  box-shadow: 0 0 0.3em black;
  text-align: justify;
  box-sizing: border-box;
  overflow: hidden;
}

.law-cards {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  gap: 10px;
  margin: 20px auto;
  max-width: 900px;
  padding: 0 20px;
}

.law-card {
  background-color: #003366;
  box-shadow: 0 0 0.3em black;
  cursor: pointer;
  transition: transform 0.3s ease;
  color: white;
  width: 250px;
  border-radius: 20px;
  overflow: hidden;
  font-family: Playfair Display;
}

.law-card a {
  text-decoration: none;
  color: white;
  display: block;
}

.law-card div {
  padding: 5px;
  text-align: center;
  font-size: 16px;
  color: white;
}

.law-card:hover {
  transform: scale(1.05);
}

.expandable-btn {
  background-color: #003366;
  color: white;
  padding: 15px;
  border: none;
  cursor: pointer;
  width: 100%;
  text-align: left;
  font-size: 16px;
  font-family: 'Tenor Sans', serif;
  transition: background-color 0.3s;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
  border-radius: 5px;
}

.expandable-btn:hover {
  background-color: #1a5490;
}

.expandable-btn.active {
  background-color: #1a5490;
}

.expandable-content {
  display: none;
  padding: 15px;
  background-color: #0a2a66;
  margin-bottom: 10px;
  border-radius: 5px;
}

.expandable-content.active {
  display: block;
}

.nested-btn {
  background-color: #1a5490;
  color: white;
  padding: 12px;
  border: none;
  cursor: pointer;
  width: 100%;
  text-align: left;
  font-size: 14px;
  font-family: 'Tenor Sans', serif;
  transition: background-color 0.3s;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
  border-radius: 5px;
}

.nested-btn:hover {
  background-color: #2e7fb8;
}

.nested-btn.active {
  background-color: #2e7fb8;
}

.nested-content {
  display: none;
  padding: 12px;
  background-color: #143d7a;
  margin-bottom: 8px;
  margin-left: 15px;
  border-radius: 5px;
}

.nested-content.active {
  display: block;
}

.article-btn {
  background-color: #2e7fb8;
  color: white;
  padding: 10px;
  border: none;
  cursor: pointer;
  width: 100%;
  text-align: left;
  font-size: 13px;
  font-family: 'Tenor Sans', serif;
  transition: background-color 0.3s;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
  border-radius: 5px;
}

.article-btn:hover {
  background-color: #4a9fd8;
}

.article-btn.active {
  background-color: #4a9fd8;
}

.article-content {
  display: none;
  padding: 10px;
  background-color: #1a5490;
  margin-bottom: 5px;
  margin-left: 15px;
  border-radius: 5px;
}

.article-content.active {
  display: block;
}

.subarticle-link {
  display: inline-block;
  background-color: #4a9fd8;
  color: white;
  padding: 8px 12px;
  text-decoration: none;
  border-radius: 5px;
  margin: 3px 0;
  font-size: 12px;
  transition: background-color 0.3s;
}

.subarticle-link:hover {
  background-color: #6bb8e8;
  text-decoration: none;
}

@media screen and (max-width: 980px) {
  .codex-title {
    font-size: 20px;
  }
  .codex-quote {
    font-size: 13px;
  }
  .law-title {
    font-size: 18px;
  }
  .law-card {
    width: 100px;
  }
  .law-card div {
    font-size: 13px;
  }
  .codex-section {
    padding: 10px;
    margin: 0px 10px 30px 10px;
  }
}
</style>

<!-- Шапка кодекса -->
<div class="codex-wrapper">
  <div class="codex-header">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Great_Seal_of_the_United_States_%28obverse%29.svg/1280px-Great_Seal_of_the_United_States_%28obverse%29.svg.png">
    <div class="codex-title">${escapeHtml(name)}</div>
    <div class="law-title-en">${escapeHtml(nameEn)}</div>
    <div class="codex-quote">"${escapeHtml(quote)}"</div>
  </div>

  <div class="codex-divider"></div>

  <!-- АКТЫ КОНГРЕССА -->
  <div class="law-header">
    <div class="codex-title">АКТЫ КОНГРЕССА</div>
    <div class="law-title-en">THE ACTS OF THE CONGRESS</div>
  </div>
`;

            sections.forEach(section => {
                const sectionNum = section.querySelector('.sectionNum').value;
                const sectionName = section.querySelector('.sectionName').value;
                const sectionNameEn = section.querySelector('.sectionNameEn').value;

                html += `
  <div class="law-header">
    <div class="law-title">Раздел ${sectionNum}. ${escapeHtml(sectionName)}</div>
    <div class="law-title-en">Title ${sectionNum}. ${escapeHtml(sectionNameEn)}</div>
  </div>
`;

                const laws = section.querySelector(`#laws-container-${Array.from(document.querySelectorAll('#sectionsContainer > .hierarchy-item')).indexOf(section)}`);
                if (laws) {
                    laws.querySelectorAll('.law').forEach(law => {
                        const lawDesignation = law.querySelector('.lawDesignation').value;
                        const lawName = law.querySelector('.lawName').value;
                        const lawNameEn = law.querySelector('.lawNameEn').value;
                        const lawNameRu = law.querySelector('.lawNameRu').value;
                        const lawLink = law.querySelector('.lawLink').value;

                        html += `
  <div class="codex-section">
    <center>
      <div class="law-title">${escapeHtml(lawDesignation)}</div>
      <div class="law-title-en">${escapeHtml(lawNameEn)}</div>
      <div class="law-title"><b>${escapeHtml(lawName)}<br>${escapeHtml(lawNameRu)}</b></div>
    </center>
    
    <div class="law-cards">
      <a href="${escapeHtml(lawLink)}" class="law-card" style="text-decoration: none;">
        <div>Полный текст</div>
      </a>
    </div>
`;

                        const chaptersContainer = law.querySelector(`#chapters-container-${Array.from(document.querySelectorAll('.law')).indexOf(law)}`);
                        if (chaptersContainer) {
                            chaptersContainer.querySelectorAll('.chapter').forEach((chapter, chIdx) => {
                                const chapterNum = chapter.querySelector('.chapterNum').value;
                                const chapterName = chapter.querySelector('.chapterName').value;
                                const chapterLink = chapter.querySelector('.chapterLink').value;
                                const chapterId = `ch-${Date.now()}-${Math.random()}`;

                                html += `
    <button class="expandable-btn" onclick="toggleContent('${chapterId}')">
      <span>Глава ${escapeHtml(chapterNum)}: ${escapeHtml(chapterName)}</span>
      <span>▼</span>
    </button>
    <div class="expandable-content" id="${chapterId}">
      <a href="${escapeHtml(chapterLink)}" style="color: #4a9fd8; text-decoration: none; display: block; margin-bottom: 10px;">→ Ссылка на главу</a>
`;

                                const articlesContainer = chapter.querySelector(`#articles-container-${Array.from(document.querySelectorAll('.chapter')).indexOf(chapter)}`);
                                if (articlesContainer) {
                                    articlesContainer.querySelectorAll('.article').forEach((article, artIdx) => {
                                        const articleNum = article.querySelector('.articleNum').value;
                                        const articleName = article.querySelector('.articleName').value;
                                        const articleLink = article.querySelector('.articleLink').value;
                                        const articleId = `art-${Date.now()}-${Math.random()}`;

                                        html += `
      <button class="nested-btn" onclick="toggleContent('${articleId}')">
        <span>Статья ${escapeHtml(articleNum)}: ${escapeHtml(articleName)}</span>
        <span>▼</span>
      </button>
      <div class="nested-content" id="${articleId}">
        <a href="${escapeHtml(articleLink)}" style="color: #6bb8e8; text-decoration: none; display: block; margin-bottom: 8px;">→ Ссылка на статью</a>
`;

                                        const subarticlesContainer = article.querySelector(`#subarticles-container-${Array.from(document.querySelectorAll('.article')).indexOf(article)}`);
                                        if (subarticlesContainer) {
                                            subarticlesContainer.querySelectorAll('.subarticle').forEach(subarticle => {
                                                const subDesignation = subarticle.querySelector('.subarticleDesignation').value;
                                                const subName = subarticle.querySelector('.subarticleName').value;
                                                const subLink = subarticle.querySelector('.subarticleLink').value;

                                                html += `
        <a href="${escapeHtml(subLink)}" class="subarticle-link">
          Подстатья ${escapeHtml(subDesignation)}: ${escapeHtml(subName)}
        </a>
`;
                                            });
                                        }

                                        html += `
      </div>
`;
                                    });
                                }

                                html += `
    </div>
`;
                            });
                        }

                        html += `
  </div>
`;
                    });
                }
            });

            html += `
  <div class="codex-divider"></div>
  <div class="law-header">
    <div class="codex-quote">Создано при поддержке Code Generator</div>
  </div>
</div>

<script>
function toggleContent(id) {
  const element = document.getElementById(id);
  const button = event.target.closest('button');
  
  if (element) {
    element.classList.toggle('active');
    button.classList.toggle('active');
    const arrow = button.querySelector('span:last-child');
    if (arrow) {
      arrow.textContent = element.classList.contains('active') ? '▲' : '▼';
    }
  }
}
</script>
`;

            return html;
        }

        function generateAddition() {
            const sections = document.querySelectorAll('#sectionsContainer > .hierarchy-item');
            
            let html = `<!-- ДОПОЛНЕНИЕ К КОДЕКСУ США (без стилей) -->
`;

            sections.forEach(section => {
                const sectionNum = section.querySelector('.sectionNum').value;
                const sectionName = section.querySelector('.sectionName').value;
                const sectionNameEn = section.querySelector('.sectionNameEn').value;

                html += `
<!-- Раздел ${sectionNum} -->
<div class="law-header">
  <div class="law-title">Раздел ${sectionNum}. ${escapeHtml(sectionName)}</div>
  <div class="law-title-en">Title ${sectionNum}. ${escapeHtml(sectionNameEn)}</div>
</div>
`;

                const sectionIndex = Array.from(document.querySelectorAll('#sectionsContainer > .hierarchy-item')).indexOf(section);
                const laws = section.querySelector(`#laws-container-${sectionIndex}`);
                if (laws) {
                    laws.querySelectorAll('.law').forEach(law => {
                        const lawDesignation = law.querySelector('.lawDesignation').value;
                        const lawName = law.querySelector('.lawName').value;
                        const lawNameEn = law.querySelector('.lawNameEn').value;
                        const lawNameRu = law.querySelector('.lawNameRu').value;
                        const lawLink = law.querySelector('.lawLink').value;

                        html += `
<!-- Закон -->
<div class="codex-section">
  <center>
    <div class="law-title">${escapeHtml(lawDesignation)}</div>
    <div class="law-title-en">${escapeHtml(lawNameEn)}</div>
    <div class="law-title"><b>${escapeHtml(lawName)}<br>${escapeHtml(lawNameRu)}</b></div>
  </center>
  
  <div class="law-cards">
    <a href="${escapeHtml(lawLink)}" class="law-card" style="text-decoration: none;">
      <div>Полный текст</div>
    </a>
  </div>
`;

                        const lawIndex = Array.from(document.querySelectorAll('.law')).indexOf(law);
                        const chaptersContainer = law.querySelector(`#chapters-container-${lawIndex}`);
                        if (chaptersContainer) {
                            chaptersContainer.querySelectorAll('.chapter').forEach((chapter, chIdx) => {
                                const chapterNum = chapter.querySelector('.chapterNum').value;
                                const chapterName = chapter.querySelector('.chapterName').value;
                                const chapterLink = chapter.querySelector('.chapterLink').value;
                                const chapterId = `ch-${Date.now()}-${Math.random()}`;

                                html += `
  <button class="expandable-btn" onclick="toggleContent('${chapterId}')">
    <span>Глава ${escapeHtml(chapterNum)}: ${escapeHtml(chapterName)}</span>
    <span>▼</span>
  </button>
  <div class="expandable-content" id="${chapterId}">
    <a href="${escapeHtml(chapterLink)}" style="color: #4a9fd8; text-decoration: none; display: block; margin-bottom: 10px;">→ Ссылка на главу</a>
`;

                                const chapterIndex = Array.from(document.querySelectorAll('.chapter')).indexOf(chapter);
                                const articlesContainer = chapter.querySelector(`#articles-container-${chapterIndex}`);
                                if (articlesContainer) {
                                    articlesContainer.querySelectorAll('.article').forEach((article, artIdx) => {
                                        const articleNum = article.querySelector('.articleNum').value;
                                        const articleName = article.querySelector('.articleName').value;
                                        const articleLink = article.querySelector('.articleLink').value;
                                        const articleId = `art-${Date.now()}-${Math.random()}`;

                                        html += `
    <button class="nested-btn" onclick="toggleContent('${articleId}')">
      <span>Статья ${escapeHtml(articleNum)}: ${escapeHtml(articleName)}</span>
      <span>▼</span>
    </button>
    <div class="nested-content" id="${articleId}">
      <a href="${escapeHtml(articleLink)}" style="color: #6bb8e8; text-decoration: none; display: block; margin-bottom: 8px;">→ Ссылка на статью</a>
`;

                                        const articleIndex = Array.from(document.querySelectorAll('.article')).indexOf(article);
                                        const subarticlesContainer = article.querySelector(`#subarticles-container-${articleIndex}`);
                                        if (subarticlesContainer) {
                                            subarticlesContainer.querySelectorAll('.subarticle').forEach(subarticle => {
                                                const subDesignation = subarticle.querySelector('.subarticleDesignation').value;
                                                const subName = subarticle.querySelector('.subarticleName').value;
                                                const subLink = subarticle.querySelector('.subarticleLink').value;

                                                html += `
      <a href="${escapeHtml(subLink)}" class="subarticle-link">
        Подстатья ${escapeHtml(subDesignation)}: ${escapeHtml(subName)}
      </a>
`;
                                            });
                                        }

                                        html += `
    </div>
`;
                                    });
                                }

                                html += `
  </div>
`;
                            });
                        }

                        html += `
</div>
`;
                    });
                }
            });

            return html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyToClipboard() {
            const code = document.getElementById('codeOutput').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const msg = document.getElementById('successMessage');
                msg.classList.add('show');
                setTimeout(() => msg.classList.remove('show'), 3000);
            });
        }

        // Инициализация - добавляем один пустой раздел при загрузке
        window.addEventListener('DOMContentLoaded', () => {
            addSection();
        });
    </script>
</body>
</html>
